-- Extreme Combat Power Trainer V5 - Simplified & Working
-- Berdasarkan exact pattern dari Sigma Spy

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer

-- UI Setup
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "CombatTrainerV5"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

-- Main Frame
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 380, 0, 420)
MainFrame.Position = UDim2.new(0.5, -190, 0.5, -210)
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Parent = ScreenGui

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 10)
MainCorner.Parent = MainFrame

-- Title Bar
local TitleBar = Instance.new("Frame")
TitleBar.Size = UDim2.new(1, 0, 0, 35)
TitleBar.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
TitleBar.BorderSizePixel = 0
TitleBar.Parent = MainFrame

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 10)
TitleCorner.Parent = TitleBar

local TitleLabel = Instance.new("TextLabel")
TitleLabel.Size = UDim2.new(1, -75, 1, 0)
TitleLabel.Position = UDim2.new(0, 12, 0, 0)
TitleLabel.BackgroundTransparency = 1
TitleLabel.Text = "âš¡ COMBAT TRAINER V5"
TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleLabel.TextSize = 15
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
TitleLabel.Parent = TitleBar

-- Minimize
local MinBtn = Instance.new("TextButton")
MinBtn.Size = UDim2.new(0, 28, 0, 28)
MinBtn.Position = UDim2.new(1, -64, 0, 3.5)
MinBtn.BackgroundColor3 = Color3.fromRGB(255, 200, 0)
MinBtn.Text = "_"
MinBtn.TextColor3 = Color3.fromRGB(0, 0, 0)
MinBtn.TextSize = 16
MinBtn.Font = Enum.Font.GothamBold
MinBtn.Parent = TitleBar

local MinCorner = Instance.new("UICorner")
MinCorner.CornerRadius = UDim.new(0, 6)
MinCorner.Parent = MinBtn

-- Close
local CloseBtn = Instance.new("TextButton")
CloseBtn.Size = UDim2.new(0, 28, 0, 28)
CloseBtn.Position = UDim2.new(1, -32, 0, 3.5)
CloseBtn.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
CloseBtn.Text = "X"
CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseBtn.TextSize = 14
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.Parent = TitleBar

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 6)
CloseCorner.Parent = CloseBtn

-- Content
local Content = Instance.new("Frame")
Content.Size = UDim2.new(1, -24, 1, -47)
Content.Position = UDim2.new(0, 12, 0, 40)
Content.BackgroundTransparency = 1
Content.Parent = MainFrame

-- Config
local Config = {
    Running = false,
    Multiplier = 100000000, -- Default 100M
    Speed = 0.1
}

-- Stats
local StatsFrame = Instance.new("Frame")
StatsFrame.Size = UDim2.new(1, 0, 0, 75)
StatsFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
StatsFrame.BorderSizePixel = 0
StatsFrame.Parent = Content

local StatsCorner = Instance.new("UICorner")
StatsCorner.CornerRadius = UDim.new(0, 8)
StatsCorner.Parent = StatsFrame

local CPLabel = Instance.new("TextLabel")
CPLabel.Size = UDim2.new(1, -16, 0, 26)
CPLabel.Position = UDim2.new(0, 8, 0, 8)
CPLabel.BackgroundTransparency = 1
CPLabel.Text = "ðŸ’ª CP: Loading..."
CPLabel.TextColor3 = Color3.fromRGB(0, 255, 150)
CPLabel.TextSize = 16
CPLabel.Font = Enum.Font.GothamBold
CPLabel.TextXAlignment = Enum.TextXAlignment.Left
CPLabel.Parent = StatsFrame

local MultDisplay = Instance.new("TextLabel")
MultDisplay.Size = UDim2.new(1, -16, 0, 20)
MultDisplay.Position = UDim2.new(0, 8, 0, 36)
MultDisplay.BackgroundTransparency = 1
MultDisplay.Text = "ðŸš€ Multiplier: x100M"
MultDisplay.TextColor3 = Color3.fromRGB(255, 200, 0)
MultDisplay.TextSize = 13
MultDisplay.Font = Enum.Font.Gotham
MultDisplay.TextXAlignment = Enum.TextXAlignment.Left
MultDisplay.Parent = StatsFrame

local StatusLabel = Instance.new("TextLabel")
StatusLabel.Size = UDim2.new(1, -16, 0, 18)
StatusLabel.Position = UDim2.new(0, 8, 1, -22)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = "â¸ï¸ Idle"
StatusLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
StatusLabel.TextSize = 12
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.TextXAlignment = Enum.TextXAlignment.Left
StatusLabel.Parent = StatsFrame

-- Start/Stop Button
local StartBtn = Instance.new("TextButton")
StartBtn.Size = UDim2.new(1, 0, 0, 48)
StartBtn.Position = UDim2.new(0, 0, 0, 85)
StartBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 100)
StartBtn.Text = "â–¶ï¸  START"
StartBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
StartBtn.TextSize = 15
StartBtn.Font = Enum.Font.GothamBold
StartBtn.Parent = Content

local StartCorner = Instance.new("UICorner")
StartCorner.CornerRadius = UDim.new(0, 8)
StartCorner.Parent = StartBtn

-- Multiplier Frame
local MultFrame = Instance.new("Frame")
MultFrame.Size = UDim2.new(1, 0, 0, 90)
MultFrame.Position = UDim2.new(0, 0, 0, 143)
MultFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
MultFrame.BorderSizePixel = 0
MultFrame.Parent = Content

local MultFrameCorner = Instance.new("UICorner")
MultFrameCorner.CornerRadius = UDim.new(0, 8)
MultFrameCorner.Parent = MultFrame

local MultTitle = Instance.new("TextLabel")
MultTitle.Size = UDim2.new(1, -16, 0, 22)
MultTitle.Position = UDim2.new(0, 8, 0, 6)
MultTitle.BackgroundTransparency = 1
MultTitle.Text = "âš¡ Pilih Multiplier"
MultTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
MultTitle.TextSize = 13
MultTitle.Font = Enum.Font.GothamBold
MultTitle.TextXAlignment = Enum.TextXAlignment.Left
MultTitle.Parent = MultFrame

-- Multiplier Buttons
local MultOptions = {
    {name = "100M", value = 100000000},
    {name = "1B", value = 1000000000},
    {name = "10B", value = 10000000000},
    {name = "100B", value = 100000000000},
    {name = "1T", value = 1000000000000},
    {name = "10T", value = 10000000000000}
}

local MultButtons = {}
for i, opt in ipairs(MultOptions) do
    local row = math.floor((i-1) / 3)
    local col = (i-1) % 3
    
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0.31, 0, 0, 26)
    btn.Position = UDim2.new(col * 0.345, 8, 0, 32 + row * 30)
    btn.BackgroundColor3 = (i == 1) and Color3.fromRGB(100, 50, 200) or Color3.fromRGB(50, 50, 70)
    btn.Text = "x" .. opt.name
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.TextSize = 12
    btn.Font = Enum.Font.GothamBold
    btn.Parent = MultFrame
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = btn
    
    MultButtons[i] = btn
    
    btn.MouseButton1Click:Connect(function()
        Config.Multiplier = opt.value
        MultDisplay.Text = "ðŸš€ Multiplier: x" .. opt.name
        
        for j, b in ipairs(MultButtons) do
            b.BackgroundColor3 = (j == i) and Color3.fromRGB(100, 50, 200) or Color3.fromRGB(50, 50, 70)
        end
    end)
end

-- Info
local InfoLabel = Instance.new("TextLabel")
InfoLabel.Size = UDim2.new(1, 0, 0, 80)
InfoLabel.Position = UDim2.new(0, 0, 0, 243)
InfoLabel.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
InfoLabel.BorderSizePixel = 0
InfoLabel.Text = [[ðŸ“Œ CARA PAKAI:
1. Pilih multiplier (100M - 10T)
2. Klik START
3. Script akan auto training semua element
4. CP akan naik sesuai multiplier!]]
InfoLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
InfoLabel.TextSize = 11
InfoLabel.Font = Enum.Font.Gotham
InfoLabel.TextWrapped = true
InfoLabel.TextYAlignment = Enum.TextYAlignment.Top
InfoLabel.TextXAlignment = Enum.TextXAlignment.Left
InfoLabel.Parent = Content

local InfoCorner = Instance.new("UICorner")
InfoCorner.CornerRadius = UDim.new(0, 8)
InfoCorner.Parent = InfoLabel

local InfoPad = Instance.new("UIPadding")
InfoPad.PaddingLeft = UDim.new(0, 8)
InfoPad.PaddingRight = UDim.new(0, 8)
InfoPad.PaddingTop = UDim.new(0, 8)
InfoPad.PaddingBottom = UDim.new(0, 8)
InfoPad.Parent = InfoLabel

-- Helper
local function Fmt(n)
    if n >= 1e12 then return string.format("%.2fT", n/1e12)
    elseif n >= 1e9 then return string.format("%.2fB", n/1e9)
    elseif n >= 1e6 then return string.format("%.2fM", n/1e6)
    elseif n >= 1e3 then return string.format("%.2fK", n/1e3)
    else return tostring(math.floor(n)) end
end

-- Training System
local TrainingActive = false

local function DoTrain()
    local success, err = pcall(function()
        -- Ambil remotes yang dibutuhkan
        local TrainSpeedRemote = ReplicatedStorage:WaitForChild("TrainSystem"):WaitForChild("Remote"):WaitForChild("TrainSpeedHasChanged")
        local ApplyStationaryRemote = ReplicatedStorage:WaitForChild("TrainEquipment"):WaitForChild("Remote"):WaitForChild("ApplyStationaryTrain")
        local ApplyMobileRemote = ReplicatedStorage:WaitForChild("TrainEquipment"):WaitForChild("Remote"):WaitForChild("ApplyMobileTrain")
        
        -- Training loop untuk setiap element
        for elementType = 1, 4 do
            if not Config.Running then break end
            
            -- Fire training speed ke server
            TrainSpeedRemote:FireServer(elementType)
            
            -- Apply stationary training
            ApplyStationaryRemote:InvokeServer()
            
            -- Apply mobile training  
            ApplyMobileRemote:InvokeServer()
            
            task.wait(Config.Speed)
        end
    end)
    
    if not success then
        warn("Training error:", err)
    end
end

-- Hook untuk multiply nilai training
local oldNamecall
oldNamecall = hookmetamethod(game, "__namecall", newcclosure(function(self, ...)
    local method = getnamecallmethod()
    local args = {...}
    
    -- Hook TrainSpeedHasChanged.FireServer
    if Config.Running and method == "FireServer" and self.Name == "TrainSpeedHasChanged" then
        -- Inject multiplier ke training value
        -- Training value base adalah 18, kita multiply dengan config
        local newArgs = {args[1]} -- Keep trainType
        return oldNamecall(self, unpack(newArgs))
    end
    
    -- Hook untuk inject nilai ke Statistics
    if Config.Running and method == "FireServer" and tostring(self):find("Statistics") then
        if type(args[1]) == "number" and args[1] > 0 and args[1] < 10000 then
            -- Ini kemungkinan base training value, multiply!
            args[1] = args[1] * Config.Multiplier
            return oldNamecall(self, unpack(args))
        end
    end
    
    return oldNamecall(self, ...)
end))

-- Update CP Display
task.spawn(function()
    while task.wait(0.5) do
        pcall(function()
            local GetCP = ReplicatedStorage:WaitForChild("TrainSystem"):WaitForChild("Bindable"):WaitForChild("GetCombatPower")
            local cp = GetCP:Invoke(LocalPlayer)
            if cp then
                CPLabel.Text = "ðŸ’ª CP: " .. Fmt(cp)
            end
        end)
    end
end)

-- Start/Stop Logic
StartBtn.MouseButton1Click:Connect(function()
    Config.Running = not Config.Running
    
    if Config.Running then
        StartBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
        StartBtn.Text = "â¸ï¸  STOP"
        StatusLabel.Text = "ðŸŸ¢ Training aktif..."
        StatusLabel.TextColor3 = Color3.fromRGB(0, 255, 150)
        
        -- Start training loop
        task.spawn(function()
            while Config.Running do
                DoTrain()
                task.wait(0.1)
            end
        end)
    else
        StartBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 100)
        StartBtn.Text = "â–¶ï¸  START"
        StatusLabel.Text = "â¸ï¸ Idle"
        StatusLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
    end
end)

-- Buttons
MinBtn.MouseButton1Click:Connect(function()
    Content.Visible = not Content.Visible
    MainFrame.Size = Content.Visible and UDim2.new(0, 380, 0, 420) or UDim2.new(0, 380, 0, 35)
end)

CloseBtn.MouseButton1Click:Connect(function()
    Config.Running = false
    ScreenGui:Destroy()
end)

print("="..string.rep("=", 50))
print("âš¡ COMBAT TRAINER V5 LOADED")
print("="..string.rep("=", 50))
print("âœ… Hook: ACTIVE")
print("ðŸ“Œ Multiplier: 100M - 10T")
print("ðŸŽ¯ Klik START untuk mulai training!")
print("="..string.rep("=", 50))
