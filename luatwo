-- Extreme Combat Power Trainer V3 - Hooked Version
-- Menggunakan hook untuk memodifikasi nilai yang dikirim ke server

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer

-- UI Setup
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ExtremeCombatTrainerV3"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

-- Main Frame
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 400, 0, 450)
MainFrame.Position = UDim2.new(0.5, -200, 0.5, -225)
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Parent = ScreenGui

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 12)
MainCorner.Parent = MainFrame

-- Shadow Effect
local Shadow = Instance.new("ImageLabel")
Shadow.Name = "Shadow"
Shadow.Size = UDim2.new(1, 30, 1, 30)
Shadow.Position = UDim2.new(0, -15, 0, -15)
Shadow.BackgroundTransparency = 1
Shadow.Image = "rbxasset://textures/ui/GuiImagePlaceholder.png"
Shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
Shadow.ImageTransparency = 0.5
Shadow.ScaleType = Enum.ScaleType.Slice
Shadow.SliceCenter = Rect.new(10, 10, 10, 10)
Shadow.ZIndex = 0
Shadow.Parent = MainFrame

-- Title Bar
local TitleBar = Instance.new("Frame")
TitleBar.Size = UDim2.new(1, 0, 0, 40)
TitleBar.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
TitleBar.BorderSizePixel = 0
TitleBar.Parent = MainFrame

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 12)
TitleCorner.Parent = TitleBar

local TitleFix = Instance.new("Frame")
TitleFix.Size = UDim2.new(1, 0, 0, 20)
TitleFix.Position = UDim2.new(0, 0, 1, -20)
TitleFix.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
TitleFix.BorderSizePixel = 0
TitleFix.Parent = TitleBar

local TitleLabel = Instance.new("TextLabel")
TitleLabel.Size = UDim2.new(1, -80, 1, 0)
TitleLabel.Position = UDim2.new(0, 15, 0, 0)
TitleLabel.BackgroundTransparency = 1
TitleLabel.Text = "‚ö° EXTREME COMBAT TRAINER V3"
TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleLabel.TextSize = 16
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
TitleLabel.Parent = TitleBar

-- Minimize Button
local MinimizeBtn = Instance.new("TextButton")
MinimizeBtn.Size = UDim2.new(0, 32, 0, 32)
MinimizeBtn.Position = UDim2.new(1, -70, 0, 4)
MinimizeBtn.BackgroundColor3 = Color3.fromRGB(255, 200, 0)
MinimizeBtn.Text = "‚îÄ"
MinimizeBtn.TextColor3 = Color3.fromRGB(0, 0, 0)
MinimizeBtn.TextSize = 18
MinimizeBtn.Font = Enum.Font.GothamBold
MinimizeBtn.Parent = TitleBar

local MinCorner = Instance.new("UICorner")
MinCorner.CornerRadius = UDim.new(0, 8)
MinCorner.Parent = MinimizeBtn

-- Close Button
local CloseBtn = Instance.new("TextButton")
CloseBtn.Size = UDim2.new(0, 32, 0, 32)
CloseBtn.Position = UDim2.new(1, -34, 0, 4)
CloseBtn.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
CloseBtn.Text = "‚úï"
CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseBtn.TextSize = 18
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.Parent = TitleBar

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 8)
CloseCorner.Parent = CloseBtn

-- Content
local Content = Instance.new("Frame")
Content.Size = UDim2.new(1, -30, 1, -55)
Content.Position = UDim2.new(0, 15, 0, 45)
Content.BackgroundTransparency = 1
Content.Parent = MainFrame

-- Config
local Config = {
    Enabled = false,
    Multiplier = 1000000,
    AutoBuff = true
}

-- Stats Display
local StatsFrame = Instance.new("Frame")
StatsFrame.Size = UDim2.new(1, 0, 0, 90)
StatsFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
StatsFrame.BorderSizePixel = 0
StatsFrame.Parent = Content

local StatsCorner = Instance.new("UICorner")
StatsCorner.CornerRadius = UDim.new(0, 10)
StatsCorner.Parent = StatsFrame

local CombatLabel = Instance.new("TextLabel")
CombatLabel.Size = UDim2.new(1, -20, 0, 30)
CombatLabel.Position = UDim2.new(0, 10, 0, 10)
CombatLabel.BackgroundTransparency = 1
CombatLabel.Text = "üí™ Combat Power: Loading..."
CombatLabel.TextColor3 = Color3.fromRGB(0, 255, 150)
CombatLabel.TextSize = 18
CombatLabel.Font = Enum.Font.GothamBold
CombatLabel.TextXAlignment = Enum.TextXAlignment.Left
CombatLabel.Parent = StatsFrame

local MultLabel = Instance.new("TextLabel")
MultLabel.Size = UDim2.new(1, -20, 0, 25)
MultLabel.Position = UDim2.new(0, 10, 0, 45)
MultLabel.BackgroundTransparency = 1
MultLabel.Text = "üöÄ Multiplier: x1M"
MultLabel.TextColor3 = Color3.fromRGB(255, 200, 0)
MultLabel.TextSize = 15
MultLabel.Font = Enum.Font.Gotham
MultLabel.TextXAlignment = Enum.TextXAlignment.Left
MultLabel.Parent = StatsFrame

local StatusLabel = Instance.new("TextLabel")
StatusLabel.Size = UDim2.new(1, -20, 0, 20)
StatusLabel.Position = UDim2.new(0, 10, 1, -25)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = "‚è∏Ô∏è Idle"
StatusLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
StatusLabel.TextSize = 13
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.TextXAlignment = Enum.TextXAlignment.Left
StatusLabel.Parent = StatsFrame

-- Main Toggle
local ToggleBtn = Instance.new("TextButton")
ToggleBtn.Size = UDim2.new(1, 0, 0, 50)
ToggleBtn.Position = UDim2.new(0, 0, 0, 100)
ToggleBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
ToggleBtn.Text = "‚ñ∂Ô∏è  START TRAINING"
ToggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleBtn.TextSize = 16
ToggleBtn.Font = Enum.Font.GothamBold
ToggleBtn.Parent = Content

local ToggleCorner = Instance.new("UICorner")
ToggleCorner.CornerRadius = UDim.new(0, 10)
ToggleCorner.Parent = ToggleBtn

-- Multiplier Selector
local MultFrame = Instance.new("Frame")
MultFrame.Size = UDim2.new(1, 0, 0, 70)
MultFrame.Position = UDim2.new(0, 0, 0, 160)
MultFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
MultFrame.BorderSizePixel = 0
MultFrame.Parent = Content

local MultFrameCorner = Instance.new("UICorner")
MultFrameCorner.CornerRadius = UDim.new(0, 10)
MultFrameCorner.Parent = MultFrame

local MultTitle = Instance.new("TextLabel")
MultTitle.Size = UDim2.new(1, -20, 0, 25)
MultTitle.Position = UDim2.new(0, 10, 0, 5)
MultTitle.BackgroundTransparency = 1
MultTitle.Text = "‚ö° Training Multiplier"
MultTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
MultTitle.TextSize = 14
MultTitle.Font = Enum.Font.GothamBold
MultTitle.TextXAlignment = Enum.TextXAlignment.Left
MultTitle.Parent = MultFrame

local MultValues = {1000000, 10000000, 100000000, 1000000000, 10000000000, 100000000000, 1000000000000}
local MultNames = {"1M", "10M", "100M", "1B", "10B", "100B", "1T"}
local currentMultIdx = 1

local MultBtn = Instance.new("TextButton")
MultBtn.Size = UDim2.new(1, -20, 0, 35)
MultBtn.Position = UDim2.new(0, 10, 0, 30)
MultBtn.BackgroundColor3 = Color3.fromRGB(100, 50, 200)
MultBtn.Text = "x" .. MultNames[currentMultIdx]
MultBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
MultBtn.TextSize = 15
MultBtn.Font = Enum.Font.GothamBold
MultBtn.Parent = MultFrame

local MultBtnCorner = Instance.new("UICorner")
MultBtnCorner.CornerRadius = UDim.new(0, 8)
MultBtnCorner.Parent = MultBtn

-- Auto Buff Toggle
local BuffToggle = Instance.new("TextButton")
BuffToggle.Size = UDim2.new(1, 0, 0, 45)
BuffToggle.Position = UDim2.new(0, 0, 0, 240)
BuffToggle.BackgroundColor3 = Color3.fromRGB(0, 150, 100)
BuffToggle.Text = "üíä Auto Buff: ON"
BuffToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
BuffToggle.TextSize = 14
BuffToggle.Font = Enum.Font.GothamBold
BuffToggle.Parent = Content

local BuffCorner = Instance.new("UICorner")
BuffCorner.CornerRadius = UDim.new(0, 10)
BuffCorner.Parent = BuffToggle

-- Info Label
local InfoLabel = Instance.new("TextLabel")
InfoLabel.Size = UDim2.new(1, 0, 0, 80)
InfoLabel.Position = UDim2.new(0, 0, 0, 295)
InfoLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
InfoLabel.BorderSizePixel = 0
InfoLabel.Text = "üìå Buff Items:\n‚Ä¢ Arms: Item18 | Legs: Item20\n‚Ä¢ Back: Item19 | Agility: Item21\nüéØ Hook akan mengalikan nilai training!"
InfoLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
InfoLabel.TextSize = 11
InfoLabel.Font = Enum.Font.Gotham
InfoLabel.TextWrapped = true
InfoLabel.TextYAlignment = Enum.TextYAlignment.Top
InfoLabel.Parent = Content

local InfoCorner = Instance.new("UICorner")
InfoCorner.CornerRadius = UDim.new(0, 10)
InfoCorner.Parent = InfoLabel

local InfoPadding = Instance.new("UIPadding")
InfoPadding.PaddingLeft = UDim.new(0, 10)
InfoPadding.PaddingRight = UDim.new(0, 10)
InfoPadding.PaddingTop = UDim.new(0, 10)
InfoPadding.PaddingBottom = UDim.new(0, 10)
InfoPadding.Parent = InfoLabel

-- Helper Functions
local function FormatNumber(num)
    if num >= 1e12 then return string.format("%.2fT", num / 1e12)
    elseif num >= 1e9 then return string.format("%.2fB", num / 1e9)
    elseif num >= 1e6 then return string.format("%.2fM", num / 1e6)
    elseif num >= 1e3 then return string.format("%.2fK", num / 1e3)
    else return tostring(math.floor(num))
    end
end

-- Hook System
local oldNamecall
oldNamecall = hookmetamethod(game, "__namecall", function(self, ...)
    local method = getnamecallmethod()
    local args = {...}
    
    -- Hook PlayerTrainValueHasChanged untuk multiply nilainya
    if method == "Fire" and self.Name == "PlayerTrainValueHasChanged" and Config.Enabled then
        if args[3] and type(args[3]) == "number" then
            -- args[3] adalah newValue
            -- Multiply dengan multiplier kita
            args[3] = args[3] * Config.Multiplier
            return oldNamecall(self, unpack(args))
        end
    end
    
    -- Hook FireServer untuk TrainSpeedHasChanged
    if method == "FireServer" and self.Name == "TrainSpeedHasChanged" and Config.Enabled then
        -- Let it pass, tapi kita udah modify nilai di atas
        return oldNamecall(self, ...)
    end
    
    -- Hook InvokeServer untuk training
    if method == "InvokeServer" and Config.Enabled then
        if self.Name == "ApplyMobileTrain" or self.Name == "ApplyStationaryTrain" then
            return oldNamecall(self, ...)
        end
    end
    
    return oldNamecall(self, ...)
end)

-- Auto Buff System
local BuffItems = {18, 19, 20, 21}
local lastBuffTime = 0

spawn(function()
    while wait(15) do
        if Config.Enabled and Config.AutoBuff then
            pcall(function()
                local TryOperatingItem = ReplicatedStorage:FindFirstChild("PlayerItemBackpack")
                    and ReplicatedStorage.PlayerItemBackpack:FindFirstChild("Remote")
                    and ReplicatedStorage.PlayerItemBackpack.Remote:FindFirstChild("TryOperatingItemByPlayer")
                
                if TryOperatingItem then
                    for _, itemId in pairs(BuffItems) do
                        TryOperatingItem:InvokeServer(
                            {GridInfo = {Id = itemId, Num = 1}, GridIndex = "401"},
                            itemId, 1,
                            {Operation = "UseItem", PointingOperation = "UseSingleBuffConsum"}
                        )
                        wait(0.5)
                    end
                end
            end)
        end
    end
end)

-- Update Combat Power
spawn(function()
    while wait(0.5) do
        pcall(function()
            local GetCombatPower = ReplicatedStorage:FindFirstChild("TrainSystem")
                and ReplicatedStorage.TrainSystem:FindFirstChild("Bindable")
                and ReplicatedStorage.TrainSystem.Bindable:FindFirstChild("GetCombatPower")
            
            if GetCombatPower then
                local cp = GetCombatPower:Invoke(LocalPlayer)
                if cp then
                    CombatLabel.Text = "üí™ Combat Power: " .. FormatNumber(cp)
                end
            end
        end)
    end
end)

-- Button Events
ToggleBtn.MouseButton1Click:Connect(function()
    Config.Enabled = not Config.Enabled
    
    if Config.Enabled then
        ToggleBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 100)
        ToggleBtn.Text = "‚è∏Ô∏è  STOP TRAINING"
        StatusLabel.Text = "üü¢ Active - Training dengan x" .. MultNames[currentMultIdx]
        StatusLabel.TextColor3 = Color3.fromRGB(0, 255, 150)
    else
        ToggleBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
        ToggleBtn.Text = "‚ñ∂Ô∏è  START TRAINING"
        StatusLabel.Text = "‚è∏Ô∏è Idle"
        StatusLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
    end
end)

MultBtn.MouseButton1Click:Connect(function()
    currentMultIdx = (currentMultIdx % #MultValues) + 1
    Config.Multiplier = MultValues[currentMultIdx]
    MultBtn.Text = "x" .. MultNames[currentMultIdx]
    MultLabel.Text = "üöÄ Multiplier: x" .. MultNames[currentMultIdx]
    
    if Config.Enabled then
        StatusLabel.Text = "üü¢ Active - Training dengan x" .. MultNames[currentMultIdx]
    end
end)

BuffToggle.MouseButton1Click:Connect(function()
    Config.AutoBuff = not Config.AutoBuff
    
    if Config.AutoBuff then
        BuffToggle.BackgroundColor3 = Color3.fromRGB(0, 150, 100)
        BuffToggle.Text = "üíä Auto Buff: ON"
    else
        BuffToggle.BackgroundColor3 = Color3.fromRGB(100, 50, 50)
        BuffToggle.Text = "üíä Auto Buff: OFF"
    end
end)

MinimizeBtn.MouseButton1Click:Connect(function()
    Content.Visible = not Content.Visible
    MainFrame.Size = Content.Visible and UDim2.new(0, 400, 0, 450) or UDim2.new(0, 400, 0, 40)
end)

CloseBtn.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

-- Notification
local function Notify(text)
    StatusLabel.Text = text
    wait(3)
    if Config.Enabled then
        StatusLabel.Text = "üü¢ Active - Training dengan x" .. MultNames[currentMultIdx]
    else
        StatusLabel.Text = "‚è∏Ô∏è Idle"
    end
end

wait(1)
Notify("‚úÖ Hook installed! Siap meningkatkan Combat Power!")

print("="..string.rep("=", 50))
print("‚ö° EXTREME COMBAT TRAINER V3 - HOOKED")
print("="..string.rep("=", 50))
print("‚úÖ Hook system: ACTIVE")
print("üìå Sistem akan mengalikan SEMUA training value dengan multiplier")
print("üéØ Multiplier range: 1M - 1T")
print("üíä Auto buff: Aktif setiap 15 detik")
print("üöÄ SEKARANG TRAINING AKAN MENGHASILKAN POIN EKSTREM!")
print("="..string.rep("=", 50))
